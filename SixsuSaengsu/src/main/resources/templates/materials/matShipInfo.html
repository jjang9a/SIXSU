<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/template}">

<head>
	<meta charset="UTF-8">
	<title>자재출고조회</title>
</head>

<body>
	<div layout:fragment="content">
		<h1 class="mt-4" style="font-family: 'MaruBuri';">자재출고조회</h1>
		<form action="" method="post" id="matShipForm">
				<table id="matShipTable">
					<tr>
						<td>공정실적코드</td>
						<td><input type="text" name="pNum" id="pNum" class="empty" placeholder="검색"></td>
					</tr>				
					<tr>
						<td>자재LOT번호</td>
						<td><input type="text" name="mlot" id="mlot" class="empty" placeholder="검색"></td>
					</tr>
					<tr>
						<td>자재명</td>
						<td><input type="text" name="mname" id="mname" class="empty" placeholder="검색"></td>
						
					</tr>
					<tr>
						<td>출고유형</td>
						<td>
							<div id="divRadio">
								<input type="radio" id="matShipStat1" name="matShipStat" value=정상출고>
								<label for="matShipStat1">정상출고</label>
								<input type="radio" id="matRecStat2" name="matShipStat" value="조정출고">
								<label for="matShipStat2">조정출고</label>
							</div>
						</td>
					</tr>
					<tr>
						<td>출고일자</td>
						<td>
							<input type="date" id="matShipDate"> ~ <input type="date" id="matShipDatee">
						</td>
					</tr>
				</table>
			</form>
			<div id="left">
				<button class="sixBtn2" id="check">조회</button>
				<button class="sixBtn4" id="reset">초기화</button>
			</div>
			
			<div id="gridm"></div>
			
		<script>
			const gridData = [
	
			];
		
			function matShipList(prcsPfmcId, matLotId, matName, matShipType, sDate, eDate){
				
				$.ajax({
					url : "/materials/matshiplist",
					method : "GET",
					data : {prcsPfmcId : prcsPfmcId, matLotId : matLotId, matName : matName, matShipType : matShipType, sDate : sDate, eDate : eDate},
					success : function(result) {
						gridm.resetData(result);
					},
 					error: function(reject) {
						console.log(reject);
					}
				});
			}
			
			let prcsPfmcId =null;
			let matLotId =null;
			let matName = null;
			let matShipType = null;
			let sDate = null;
			let eDate = null;
			matShipList(prcsPfmcId, matLotId, matName, matShipType, sDate, eDate);
			
			$('#check').click(function(){
				prcsPfmcId = $('#pNum').val();
				matLotId = $('#mlot').val();
				matName = $('#mname').val();
				matShipType = $("input[name='matShipStat']:checked").val();
				sDate = $('#matShipDate').val();
				eDate = $('#matShipDatee').val();
				matShipList(prcsPfmcId, matLotId, matName, matShipType, sDate, eDate);
			})
			
			$('#reset').click(function(){
				$('#pNum').val('');
				$('#mlot').val('');
				$('#mname').val('');
				$("input[name='matShipStat']:checked").val('');
				$('#matShipDate').val('');
				$('#matShipDatee').val('');
				prcsPfmcId = $('#pNum').val();
				matLotId = $('#mlot').val();
				matName = $('#mname').val();
				matShipType = $("input[name='matShipStat']:checked").val();
				sDate = $('#matShipDate').val();
				eDate = $('#matShipDatee').val();
				$('input[type="radio"]').prop('checked', false);
				matShipList(prcsPfmcId, matLotId, matName, matShipType, sDate, eDate);
			})
			
			const gridm = new tui.Grid({
				el : document.getElementById('gridm'),
				//data : gridData,
				scrollX : false,
				scrollY : false,
				pageOptions: {
					useClient: true,
					perPage: 10
				},
				rowHeaders: ['rowNum'],
				columns : [ 
					{
					header : '공정실적코드',
					name : 'prcsPfmcId',
				}, {
					header : '자재LOT번호',
					name : 'matLotId'
				}, {
					header : '자재명',
					name : 'matName'
				}, {
					header : '출고량',
					name : 'matShipQt'
				}, {
					header : '출고일자',
					name : 'matShipDate'
				}, {
					header : '출고유형',
					name : 'matShipType'
				}, {
					header : '담당자',
					name : 'empName'
				}, {
					header : '비고',
					name : 'matShipNote'
				}]
			});
			
 			tui.Grid.applyTheme('default', {
				cell: {
					header: {
						background: '#e5edf5'
					},
					rowHeader: {
						background: '#e5edf5'
					},
					normal: {
						background: '#ffffff'
					}
				}
			});
		</script>
	</div>
</body>

</html>