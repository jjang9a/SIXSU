<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
 	layout:decorate="~{layout/template}">
<head>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<meta charset="UTF-8">
<title>(주)SIXSU</title>

</head>

<body>
	<div id="grid"></div>
	<button>도착 등록</button>
	
<script>

	let girdData = [];

	window.onload = function(){
    $.ajax({
        url : "/quality/arrRegList",
        method :"GET",
        dataType : "JSON",
        success : function(result){
            grid.resetData(result);
        } 
    });
};

class RowNumberRenderer {
    constructor(props) {
      const el = document.createElement('span');
      el.innerHTML = `No.${props.formattedValue}`;
      this.el = el;
    }

    getElement() {
      return this.el;
    }

    render(props) {
      this.el.innerHTML = `No.${props.formattedValue}`;
    }
  }

  class CheckboxRenderer {
    constructor(props) {
      const { grid, rowKey } = props;

      const label = document.createElement('label');
      label.className = 'checkbox tui-grid-row-header-checkbox';
      label.setAttribute('for', String(rowKey));

      const hiddenInput = document.createElement('input');
      hiddenInput.className = 'hidden-input';
      hiddenInput.id = String(rowKey);

      const customInput = document.createElement('span');
      customInput.className = 'custom-input';

      label.appendChild(hiddenInput);
      label.appendChild(customInput);

      hiddenInput.type = 'checkbox';
      label.addEventListener('click', (ev) => {
        ev.preventDefault();

        if (ev.shiftKey) {
          grid[!hiddenInput.checked ? 'checkBetween' : 'uncheckBetween'](rowKey);
          return;
        }

        grid[!hiddenInput.checked ? 'check' : 'uncheck'](rowKey);
      });

      this.el = label;

      this.render(props);
    }

    getElement() {
      return this.el;
    }

    render(props) {
      const hiddenInput = this.el.querySelector('.hidden-input');
      const checked = Boolean(props.value);

      hiddenInput.checked = checked;
    }
  }

  const grid = new tui.Grid({
    el: document.getElementById('grid'),
    data: gridData,
    rowHeaders: [
      {
        type: 'rowNum',
        renderer: {
          type: RowNumberRenderer
        }
      },
      {
        type: 'checkbox',
        header: `
        <label for="all-checkbox" class="checkbox">
          <input type="checkbox" id="all-checkbox" class="hidden-input" name="_checked" />
          <span class="custom-input"></span>
        </label>
      `,
        renderer: {
          type: CheckboxRenderer
        }
      }
    ],
    columns: [
      {
        header: '발주번호',
        name: 'matReqId'
      },
      {
        header: '거래처',
        name: 'busId'
      },
      {
        header: '자재코드',
        name: 'matId'
      },
      {
        header: '자재명',
        name: 'matName'
      }
    ]
  });

  grid.on('check', function(ev) {
    console.log('check', ev);
  });

  grid.on('uncheck', function(ev) {
    console.log('uncheck', ev);
  });
</script>
</body>
</html>