<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="co.sixsu.app.basic.mapper.BasicMapper">

<select id="getDate" resultType="java.util.Date">
	select sysdate from dual
</select>

<!-- 사원 관리 -->
<select id="empList" resultType="EmpVO">
	select emp_id, emp_name, emp_tell, TO_CHAR(emp_birth, 'yyyy/MM/dd') emp_birth, TO_CHAR(emp_hire, 'yyyy/MM/dd') emp_hire, emp_dept, emp_rk, emp_stat, emp_note  
	from employee
	order by emp_stat, emp_id
</select>

<update id="updatePw" parameterType="EmpVO">
	update employee
	set emp_pw = #{empPw}
	where emp_id = #{empId}
</update>

<insert id="addEmp" parameterType="EmpVO">
	insert into employee values (
	#{empId}, #{empName}, #{empTell}, TO_DATE(#{empBirth}, 'yyyy-MM-dd'), TO_DATE(#{empHire}, 'yyyy-MM-dd'), #{empDept}, #{empRk}, #{empStat}, #{empNote}, #{empPw} 
	)
</insert>

<update id="updateEmp" parameterType="EmpVO">
	update employee
	set emp_name=#{empName}, emp_tell=#{empTell}, emp_dept=#{empDept}, emp_rk=#{empRk}, emp_note=#{empNote}
	where emp_id=#{empId}
</update>
<!-- 사원 관리 종료 -->

<!-- 공통코드 관리 -->
<select id="groupList" resultType="CodeVO">
	select * from group_code
</select>

<select id="commList" parameterType="SearchDTO" resultType="CodeVO">
	SELECT *
	FROM common_code
	WHERE 
	<if test='searchType.equals("group")'>
		g_id = #{searchKey}
	</if>
	<if test='searchType.equals("code")'>
		com_id like '%'||#{searchKey}||'%'
	</if>
	<if test='searchType.equals("name")'>
		com_name like '%'||#{searchKey}||'%'
	</if>
	ORDER BY com_stat desc, com_id
</select>

<insert id="addCode" parameterType="CodeVO">
	INSERT INTO common_code VALUES(#{comId}, #{gId}, #{comName}, #{comNote}, #{comStat})
</insert>

<update id="updateCode" parameterType="CodeVO">
	UPDATE common_code
	SET com_name = #{comName}, com_note = #{comNote}, com_stat = #{comStat}
	WHERE com_id = #{comId}	
</update>
<!-- 공통코드 관리 종료 -->

<!-- 완제품 관리 -->
<select id="cpList" resultType="ProductVO">
	select * from complete_prod
	order by cp_stat desc, cp_id
</select>

<insert id="addCp" parameterType="ProductVO">
	INSERT INTO complete_prod VALUES (#{cpId}, #{cpName}, #{cpSize}, #{cpLot}, #{cpUnit}, #{cpStat}, #{cpNote})
</insert>

<update id="updateCp" parameterType="ProductVO">
	UPDATE complete_prod
	SET cp_name=#{cpName}, cp_size=#{cpSize}, cp_lot=#{cpLot}, cp_unit=#{cpUnit}, cp_stat=#{cpStat}, cp_note=#{cpNote}
	WHERE cp_id = #{cpId}
</update>

<select id="searchCp" parameterType="SearchDTO" resultType="ProductVO">
	SELECT *
	FROM complete_prod
	WHERE 
	<if test='searchType.equals("id")'>
		cp_id like '%'||#{searchKey}||'%' OR lower(cp_id) like '%'||#{searchKey}||'%'
	</if>
	<if test='searchType.equals("name")'>
		cp_name like '%'||#{searchKey}||'%'
	</if>
	ORDER BY cp_stat desc, cp_id
</select>
<!-- 완제품 관리 종료 -->

<!-- 반제품 관리 -->
<select id="spList" resultType="ProductVO">
	select * from semi_prod
	order by sp_stat desc, sp_id
</select>

<insert id="addSp" parameterType="ProductVO">
	INSERT INTO semi_prod VALUES (#{spId}, #{spName}, #{spSize}, #{spLot}, #{spUnit}, #{spStat}, #{spNote})
</insert>

<update id="updateSp" parameterType="ProductVO">
	UPDATE semi_prod
	SET sp_name=#{spName}, sp_size=#{spSize}, sp_lot=#{spLot}, sp_unit=#{spUnit}, sp_stat=#{spStat}, sp_note=#{spNote}
	WHERE sp_id = #{spId}
</update>

<select id="searchSp" parameterType="SearchDTO" resultType="ProductVO">
	SELECT *
	FROM semi_prod
	WHERE 
	<if test='searchType.equals("id")'>
		sp_id like '%'||#{searchKey}||'%' OR lower(sp_id) like '%'||#{searchKey}||'%'
	</if>
	<if test='searchType.equals("name")'>
		sp_name like '%'||#{searchKey}||'%'
	</if>
	ORDER BY sp_stat desc, sp_id
</select>
<!-- 반제품 관리 종료 -->

</mapper>